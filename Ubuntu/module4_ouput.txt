auditd package is not installed. Installing it now...
auditd service is already enabled.
auditd service is already active.
grep: /boot/grub/grub.conf: No such file or directory
Kernel boot parameters found, but auditing is not enabled. Enabling it now...
max_log_file is set to  8 in /etc/audit/auditd.conf. Setting it to 1024...
Audit log file is not configured in /etc/audit/auditd.conf.
max_log_file_action is set to  ROTATE in /etc/audit/auditd.conf. Setting it to keep_logs...
disk_full_action is set to  SUSPEND in /etc/audit/auditd.conf. Setting it to halt...
Defaults log_input is not set in /etc/sudoers or /etc/sudoers.d/* files. Setting it now...
./Ubuntu_CIS_Module_4.sh: line 231: /etc/sudoers.d/*: ambiguous redirect
Failed to set Defaults log_input in /etc/sudoers.d/* files.
Defaults log_output is not set in /etc/sudoers or /etc/sudoers.d/* files. Setting it now...
./Ubuntu_CIS_Module_4.sh: line 250: /etc/sudoers.d/*: ambiguous redirect
Failed to set Defaults log_output in /etc/sudoers.d/* files.
Defaults log_file is not set in /etc/sudoers or /etc/sudoers.d/* files. Setting it now...
./Ubuntu_CIS_Module_4.sh: line 269: /etc/sudoers.d/*: ambiguous redirect
Failed to set Defaults log_file in /etc/sudoers.d/* files.
time-change rule is not present in /etc/audit/rules.d/*.rules files. Adding it now...
sethostname rule is not present in /etc/audit/rules.d/*.rules files. Adding it now...
Privileged commands are not being collected. Adding rule to /etc/audit/rules.d/privileged.rules...
Unsuccessful file access attempts are not being collected. Adding rule to /etc/audit/rules.d/file-access.rules...
User/group modification events are not being collected. Adding rule to /etc/audit/rules.d/user-group.rules...
Job for auditd.service failed.
See "systemctl status auditd.service" and "journalctl -xeu auditd.service" for details.
Discretionary access control permission modification events are not being collected. Adding rule to /etc/audit/rules.d/perm-mod.rules...
Job for auditd.service failed.
See "systemctl status auditd.service" and "journalctl -xeu auditd.service" for details.
Successful file system mounts are not being collected. Adding rule to /etc/audit/rules.d/mounts.rules...
Job for auditd.service failed.
See "systemctl status auditd.service" and "journalctl -xeu auditd.service" for details.
Session initiation information is not being collected. Adding rule to /etc/audit/rules.d/session.rules...
Job for auditd.service failed.
See "systemctl status auditd.service" and "journalctl -xeu auditd.service" for details.
Failed to restart auditd service.
Login and logout events are not being collected. Adding rule to /etc/audit/rules.d/logins.rules...
Job for auditd.service failed.
See "systemctl status auditd.service" and "journalctl -xeu auditd.service" for details.
Failed to restart auditd service.
File deletion events by users are being collected.
Events that modify the system's Mandatory Access Controls are not being collected. Adding rule to /etc/audit/rules.d/mac-policy.rules...
Job for auditd.service failed.
See "systemctl status auditd.service" and "journalctl -xeu auditd.service" for details.
Failed to restart auditd service.
Successful and unsuccessful attempts to use the chcon command are not being collected. Adding rule to /etc/audit/rules.d/chcon.rules...
Job for auditd.service failed.
See "systemctl status auditd.service" and "journalctl -xeu auditd.service" for details.
Failed to restart auditd service.
Successful and unsuccessful attempts to use the setfacl command are not being collected. Adding rule to /etc/audit/rules.d/setfacl.rules...
Job for auditd.service failed.
See "systemctl status auditd.service" and "journalctl -xeu auditd.service" for details.
Failed to restart auditd service.
Successful and unsuccessful attempts to use the chacl command are not being collected. Adding rule to /etc/audit/rules.d/chacl.rules...
Job for auditd.service failed.
See "systemctl status auditd.service" and "journalctl -xeu auditd.service" for details.
Failed to restart auditd service.
Successful and unsuccessful attempts to use the usermod command are not being collected. Adding rule to /etc/audit/rules.d/usermod.rules...
Job for auditd.service failed.
See "systemctl status auditd.service" and "journalctl -xeu auditd.service" for details.
Failed to restart auditd service.
Kernel module loading, unloading, and modification events are not being collected. Adding rule to /etc/audit/rules.d/modules.rules...
Job for auditd.service failed.
See "systemctl status auditd.service" and "journalctl -xeu auditd.service" for details.
Failed to restart auditd service.
The audit configuration is not immutable. Adding '-e 2' to /etc/audit/audit.rules and /etc/audit/rules.d/*.rules...
Job for auditd.service failed.
See "systemctl status auditd.service" and "journalctl -xeu auditd.service" for details.
Failed to restart auditd service.
Failed to execute auditctl command.
stat: cannot statx '=': No such file or directory
Audit log file permissions are not 0640 or less permissive. Setting permissions to 0640...
chmod: cannot access '=': No such file or directory
Failed to set audit log file permissions to 0640.
stat: cannot statx '=': No such file or directory
stat: cannot statx '=': No such file or directory
Audit log file ownership is not authorized. Setting ownership to root:audit...
chown: invalid group: ‘root:audit’
Failed to set audit log file ownership to root:audit.
stat: cannot statx '=': No such file or directory
Audit log file group ownership is not authorized. Setting group ownership to audit...
chgrp: invalid group: ‘audit’
Failed to set audit log file group ownership to audit.
Failed to find dir entry in /etc/audit/auditd.conf.
Audit configuration files are 640 or more restrictive.
Audit configuration files are not owned by root. Setting ownership to root...
Audit configuration files do not belong to group root. Setting group ownership to root...
find: ‘/sbin/audispd’: No such file or directory
find: ‘/sbin/audisp-remote’: No such file or directory
find: ‘/sbin/audispd-plugins’: No such file or directory
find: ‘/sbin/auditwheel’: No such file or directory
Audit tools are not 755 or more restrictive. Setting permissions to 755...
find: ‘/sbin/audispd’: No such file or directory
find: ‘/sbin/audisp-remote’: No such file or directory
find: ‘/sbin/audispd-plugins’: No such file or directory
find: ‘/sbin/auditwheel’: No such file or directory
Failed to set audit tools permissions to 755.
find: ‘/sbin/audispd’: No such file or directory
find: ‘/sbin/audisp-remote’: No such file or directory
find: ‘/sbin/audispd-plugins’: No such file or directory
find: ‘/sbin/auditwheel’: No such file or directory
Audit tools are not owned by root. Setting ownership to root...
find: ‘/sbin/audispd’: No such file or directory
find: ‘/sbin/audisp-remote’: No such file or directory
find: ‘/sbin/audispd-plugins’: No such file or directory
find: ‘/sbin/auditwheel’: No such file or directory
Failed to set audit tools ownership to root.
find: ‘/sbin/audispd’: No such file or directory
find: ‘/sbin/audisp-remote’: No such file or directory
find: ‘/sbin/audispd-plugins’: No such file or directory
find: ‘/sbin/auditwheel’: No such file or directory
Audit tools do not belong to group root. Setting group ownership to root...
find: ‘/sbin/audispd’: No such file or directory
find: ‘/sbin/audisp-remote’: No such file or directory
find: ‘/sbin/audispd-plugins’: No such file or directory
find: ‘/sbin/auditwheel’: No such file or directory
Failed to set audit tools group ownership to root.
Creating directory /etc/audit/keys...
Generating key pair for audit tools...
Failure must be 0, 1, or 2 was -k
Failed to generate key pair for audit tools.
Ensuring systemd-journal-remote is installed...
Installing systemd-journal-remote...
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
The following additional packages will be installed:
  libmicrohttpd12 libnss-systemd libpam-systemd libsystemd0 systemd systemd-sysv
Suggested packages:
  systemd-container libtss2-rc0
The following NEW packages will be installed:
  libmicrohttpd12 systemd-journal-remote
The following packages will be upgraded:
  libnss-systemd libpam-systemd libsystemd0 systemd systemd-sysv
5 upgraded, 2 newly installed, 0 to remove and 36 not upgraded.
Need to get 5391 kB of archives.
After this operation, 599 kB of additional disk space will be used.
Get:1 http://us-east-2.ec2.archive.ubuntu.com/ubuntu jammy-updates/main amd64 systemd-sysv amd64 249.11-0ubuntu3.11 [10.5 kB]
Get:2 http://us-east-2.ec2.archive.ubuntu.com/ubuntu jammy-updates/main amd64 libnss-systemd amd64 249.11-0ubuntu3.11 [133 kB]
Get:3 http://us-east-2.ec2.archive.ubuntu.com/ubuntu jammy-updates/main amd64 libpam-systemd amd64 249.11-0ubuntu3.11 [203 kB]
Get:4 http://us-east-2.ec2.archive.ubuntu.com/ubuntu jammy-updates/main amd64 systemd amd64 249.11-0ubuntu3.11 [4581 kB]
Get:5 http://us-east-2.ec2.archive.ubuntu.com/ubuntu jammy-updates/main amd64 libsystemd0 amd64 249.11-0ubuntu3.11 [318 kB]
Get:6 http://us-east-2.ec2.archive.ubuntu.com/ubuntu jammy/universe amd64 libmicrohttpd12 amd64 0.9.75-3ubuntu1 [77.6 kB]
Get:7 http://us-east-2.ec2.archive.ubuntu.com/ubuntu jammy-updates/universe amd64 systemd-journal-remote amd64 249.11-0ubuntu3.11 [68.3 kB]
Fetched 5391 kB in 0s (39.8 MB/s)            
(Reading database ... 64815 files and directories currently installed.)
Preparing to unpack .../systemd-sysv_249.11-0ubuntu3.11_amd64.deb ...
Unpacking systemd-sysv (249.11-0ubuntu3.11) over (249.11-0ubuntu3.10) ...
Preparing to unpack .../libnss-systemd_249.11-0ubuntu3.11_amd64.deb ...
Unpacking libnss-systemd:amd64 (249.11-0ubuntu3.11) over (249.11-0ubuntu3.10) ...
Preparing to unpack .../libpam-systemd_249.11-0ubuntu3.11_amd64.deb ...
Unpacking libpam-systemd:amd64 (249.11-0ubuntu3.11) over (249.11-0ubuntu3.10) ...
Preparing to unpack .../systemd_249.11-0ubuntu3.11_amd64.deb ...
Unpacking systemd (249.11-0ubuntu3.11) over (249.11-0ubuntu3.10) ...
Preparing to unpack .../libsystemd0_249.11-0ubuntu3.11_amd64.deb ...
Unpacking libsystemd0:amd64 (249.11-0ubuntu3.11) over (249.11-0ubuntu3.10) ...
Setting up libsystemd0:amd64 (249.11-0ubuntu3.11) ...
Selecting previously unselected package libmicrohttpd12:amd64.
(Reading database ... 64815 files and directories currently installed.)
Preparing to unpack .../libmicrohttpd12_0.9.75-3ubuntu1_amd64.deb ...
Unpacking libmicrohttpd12:amd64 (0.9.75-3ubuntu1) ...
Selecting previously unselected package systemd-journal-remote.
Preparing to unpack .../systemd-journal-remote_249.11-0ubuntu3.11_amd64.deb ...
Unpacking systemd-journal-remote (249.11-0ubuntu3.11) ...
Setting up systemd (249.11-0ubuntu3.11) ...
Setting up libmicrohttpd12:amd64 (0.9.75-3ubuntu1) ...
Setting up systemd-sysv (249.11-0ubuntu3.11) ...
Setting up libnss-systemd:amd64 (249.11-0ubuntu3.11) ...
Setting up systemd-journal-remote (249.11-0ubuntu3.11) ...
Setting up libpam-systemd:amd64 (249.11-0ubuntu3.11) ...
Processing triggers for man-db (2.10.2-1) ...
Processing triggers for dbus (1.12.20-2ubuntu4.1) ...
Processing triggers for libc-bin (2.35-0ubuntu3.3) ...
Scanning processes...                                                                                                                                                          
Scanning candidates...                                                                                                                                                         
Scanning linux images...                                                                                                                                                       

Running kernel seems to be up-to-date.

Restarting services...
 systemctl restart multipathd.service packagekit.service polkit.service rsyslog.service ssh.service
Service restarts being deferred:
 /etc/needrestart/restart.d/dbus.service
 systemctl restart networkd-dispatcher.service
 systemctl restart systemd-logind.service
 systemctl restart unattended-upgrades.service
 systemctl restart user@1000.service

No containers need to be restarted.

No user sessions are running outdated binaries.

No VM guests are running outdated hypervisor (qemu) binaries on this host.
Enabling systemd-journal-remote service...
Created symlink /etc/systemd/system/sockets.target.wants/systemd-journal-remote.socket → /lib/systemd/system/systemd-journal-remote.socket.
Enabling journald service...
The unit files have no installation config (WantedBy=, RequiredBy=, Also=,
Alias= settings in the [Install] section, and DefaultInstance= for template
units). This means they are not meant to be enabled using systemctl.
 
Possible reasons for having this kind of units are:
• A unit may be statically enabled by being symlinked from another unit's
  .wants/ or .requires/ directory.
• A unit's purpose may be to act as a helper for some other unit which has
  a requirement dependency on it.
• A unit may be started when needed via activation (socket, path, timer,
  D-Bus, udev, scripted systemctl call, ...).
• In case of template units, the unit is meant to be enabled with some
  instance name specified.
Configuring journald to compress large log files...
journald is now configured to compress large log files.
Configuring journald to write logfiles to persistent disk...
journald is now configured to write logfiles to persistent disk.
Checking if journald is configured to send logs to rsyslog...
Configuring journald to not send logs to rsyslog...
journald is now configured to not send logs to rsyslog.
Configuring journald log rotation...
journald log rotation is now configured.
Configuring journald default file permissions...
journald default file permissions are now configured.
Checking if rsyslog is installed...
rsyslog is already installed.
Checking if rsyslog service is enabled...
rsyslog service is already enabled.
Configuring journald to send logs to rsyslog...
journald is now configured to send logs to rsyslog.
Job for systemd-journald.service failed.
See "systemctl status systemd-journald.service" and "journalctl -xeu systemd-journald.service" for details.
Configuring rsyslog default file permissions...
rsyslog default file permissions are already configured.
Configuring logrotate to rotate logs...
logrotate is already configured to rotate logs.
Configuring logrotate to send logs to syslog...
logrotate is now configured to send logs to syslog.
Configuring logrotate to compress logs...
logrotate is now configured to compress logs.
Configuring logrotate to keep logs for 30 days...
logrotate is now configured to keep logs for 30 days.
